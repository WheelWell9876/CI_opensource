<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>GeoJSON Editor - CI Sentinel</title>
  <link rel="stylesheet" href="{{ url_for('static', filename='styles/index.css') }}">
  <link rel="stylesheet" href="{{ url_for('static', filename='styles/editor_modern.css') }}">
</head>
<body>
  <!-- Header -->
  <header>
    <div class="logo">
      <a href="{{ url_for('main.index') }}" class="logo-link">
        <div class="custom-loader"></div>
        <span class="logo-title">CI Sentinel</span>
      </a>
    </div>
    <nav>
      <div class="nav-links-container">
        <li><a href="{{ url_for('main.index') }}">Home</a></li>
        <li><a href="{{ url_for('main.about') }}">About</a></li>
        <li><a href="{{ url_for('main.editor_page') }}">Editor</a></li>
        <li><a href="{{ url_for('main.datasets') }}">Datasets</a></li>
        <li><a href="{{ url_for('main.docs_page') }}">Docs</a></li>
        <li><a href="{{ url_for('main.contact') }}">Contact</a></li>
      </div>
    </nav>
  </header>

  <!-- Main Container -->
  <div class="container">
    <!-- Workflow Steps -->
    <div class="workflow-header">
      <div class="steps">
        <div class="step active" data-step="1">
          <div class="step-number">1</div>
          <div class="step-title">Load Data</div>
          <div class="step-line"></div>
        </div>
        <div class="step" data-step="2">
          <div class="step-number">2</div>
          <div class="step-title">Select Fields</div>
          <div class="step-line"></div>
        </div>
        <div class="step" data-step="3">
          <div class="step-number">3</div>
          <div class="step-title">Apply Weights</div>
          <div class="step-line"></div>
        </div>
        <div class="step" data-step="4">
          <div class="step-number">4</div>
          <div class="step-title">Export</div>
        </div>
      </div>
    </div>

    <!-- Main Content Area -->
    <div class="main-content">
      <!-- Left Panel - Input/Configuration -->
      <div class="panel">
        <!-- Step 1: Load Data -->
        <div class="step-content active" data-step="1">
          <div class="panel-title">
            <div class="panel-icon">üìÅ</div>
            Load Your GeoJSON Data
          </div>

          <!-- Upload Area -->
          <div class="upload-area" id="uploadArea">
            <div class="upload-icon">üì§</div>
            <h3>Drop your GeoJSON file here</h3>
            <p style="color: #999; margin: 1rem 0;">or click to browse</p>
            <input type="file" id="fileInput" accept=".json,.geojson" style="display: none;">
          </div>

          <div style="margin: 2rem 0; text-align: center; color: #999;">
            ‚Äî OR ‚Äî
          </div>

          <!-- API Selection -->
          <div class="input-group">
            <label class="input-label">Select a Provided API</label>
            <select id="apiSelect">
              <option value="">Choose an API...</option>
              <option value="epa-disaster">EPA Disaster Debris Recovery</option>
              <option value="agri-minerals">Agricultural Minerals Operations</option>
              <option value="construction-minerals">Construction Minerals Operations</option>
              <option value="usace-reservoirs">USACE Reservoirs</option>
              <option value="dams">National Dam Inventory</option>
            </select>
          </div>

          <div class="input-group">
            <label class="input-label">Or Enter Custom API URL</label>
            <input type="url" id="customApiUrl" placeholder="https://services.example.com/...">
          </div>

          <button class="btn btn-primary" style="width: 100%;" onclick="loadData()">
            Load Data
          </button>
        </div>

        <!-- Step 2: Select Fields -->
        <div class="step-content" data-step="2">
          <div class="panel-title">
            <div class="panel-icon">‚úÖ</div>
            Select Fields to Include
          </div>

          <div class="quick-actions">
            <div class="quick-action" onclick="selectAll()">
              <strong>Select All</strong>
            </div>
            <div class="quick-action" onclick="selectNone()">
              <strong>Select None</strong>
            </div>
            <div class="quick-action" onclick="selectQuantitative()">
              <strong>Quantitative Only</strong>
            </div>
          </div>

          <div class="field-list" id="fieldList">
            <!-- Fields will be populated here -->
          </div>

          <div class="btn-group">
            <button class="btn btn-secondary" onclick="goToStep(1)">Back</button>
            <button class="btn btn-primary" onclick="goToStep(3)">Continue</button>
          </div>
        </div>

        <!-- Step 3: Apply Weights -->
        <div class="step-content" data-step="3">
          <div class="panel-title">
            <div class="panel-icon">‚öñÔ∏è</div>
            Apply Weights to Fields
          </div>

          <div class="status-message status-info">
            <span>‚ÑπÔ∏è</span>
            <span>Adjust the weights below to prioritize certain fields. Weights will be normalized automatically.</span>
          </div>

          <div id="weightControls">
            <!-- Weight controls will be populated here -->
          </div>

          <div class="btn-group">
            <button class="btn btn-secondary" onclick="goToStep(2)">Back</button>
            <button class="btn btn-primary" onclick="goToStep(4)">Continue</button>
          </div>
        </div>

        <!-- Step 4: Export -->
        <div class="step-content" data-step="4">
          <div class="panel-title">
            <div class="panel-icon">üíæ</div>
            Export Configuration
          </div>

          <div class="input-group">
            <label class="input-label">Dataset Name</label>
            <input type="text" id="datasetName" placeholder="Enter a name for your dataset">
          </div>

          <div class="input-group">
            <label class="input-label">Description</label>
            <textarea id="datasetDescription" rows="3" placeholder="Describe your dataset..."></textarea>
          </div>

          <div class="btn-group">
            <button class="btn btn-secondary" onclick="goToStep(3)">Back</button>
            <button class="btn btn-primary" onclick="exportConfig()">
              Export Configuration
            </button>
          </div>

          <div style="margin-top: 2rem;">
            <h4 style="margin-bottom: 1rem;">Quick Export Options:</h4>
            <div class="quick-actions">
              <div class="quick-action" onclick="downloadJSON()">
                <strong>üìÑ Download JSON</strong>
              </div>
              <div class="quick-action" onclick="copyPython()">
                <strong>üêç Copy Python Code</strong>
              </div>
              <div class="quick-action" onclick="saveToServer()">
                <strong>‚òÅÔ∏è Save to Server</strong>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Right Panel - Preview -->
      <div class="panel">
        <div class="panel-title">
          <div class="panel-icon">üëÅÔ∏è</div>
          Live Preview
        </div>

        <div class="preview-tabs">
          <button class="preview-tab active" onclick="switchPreview('data')">Data Sample</button>
          <button class="preview-tab" onclick="switchPreview('schema')">Schema</button>
          <button class="preview-tab" onclick="switchPreview('python')">Python Code</button>
          <button class="preview-tab" onclick="switchPreview('stats')">Statistics</button>
        </div>

        <div class="preview-content" id="previewContent">
          <div id="previewData" class="preview-pane">
            <p style="color: #999;">Load data to see preview...</p>
          </div>
          <div id="previewSchema" class="preview-pane" style="display: none;">
            <p style="color: #999;">Schema will appear here...</p>
          </div>
          <div id="previewPython" class="preview-pane" style="display: none;">
            <pre><code>Python code will be generated here...</code></pre>
          </div>
          <div id="previewStats" class="preview-pane" style="display: none;">
            <p style="color: #999;">Statistics will appear here...</p>
          </div>
        </div>
      </div>
    </div>
  </div>
  <footer>
    <p>&copy; 2025 CI Sentinel</p>
    <p>Created by Thomas Numnum</p>
  </footer>
  <script src="{{ url_for('static', filename='scripts/jsonEditor/editor_modern.js') }}"></script>
</body>
</html>